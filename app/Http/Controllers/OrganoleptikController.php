<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use Illuminate\Support\Facades\DB;
use Illuminate\Routing\Controller;
use App\Models\organoleptik;
class OrganoleptikController extends Controller
{
    public function index(Request $request){

        $list = DB::connection('sqlsrv2')->table('v_data_header')
            ->select('id_ppk', 'no_ppk', 'nm_trader', 'tgl_ppk')
            ->get();
        $header=NULL;

        return view('admin.organoleptik',[
            'title'=>'Organoleptik',
            'list'=>$list,
            'header'=>$header
        ]);
    }

    public function organoleptik(Request $request){

        $id_ppk = request()->segment(3);
        $list = DB::connection('sqlsrv2')->table('v_data_header')
            ->select('id_ppk', 'no_ppk', 'nm_trader', 'tgl_ppk')
            ->get();

        $header = DB::connection('sqlsrv2')->table('v_data_header')
            ->where('id_ppk',$id_ppk)
            ->select('id_ppk', 'no_ppk', 'nm_trader', 'tgl_ppk')
            ->get();


        $check = DB::connection('sqlsrv2')->table('organoleptik')
            ->where('id_ppk',$id_ppk)
            ->orderBy('id_ppk','desc')
            ->select('*')
            ->get();
        //dd($check);

        return view('admin.organoleptik',[
            'title'=>'Organoleptik',
            'list'=>$list,
            'header'=>$header,
            'check' => ($check->isNotEmpty()) ? $check : null,
            
        ]);
    }

    public function submit(Request $request){

        $id_ppk = request()->segment(3);

        $ada = DB::connection('sqlsrv2')->table('organoleptik')
            ->where('id_ppk',$id_ppk)
            ->select('*')
            ->get();

        if(count($ada) > 0){
            organoleptik::where('id_ppk', $id_ppk)->update([
                "A91"=>$request->A91,
                "A92"=>$request->A92,
                "A93"=>$request->A93,
                "A94"=>$request->A94,
                "A95"=>$request->A95,
                "A96"=>$request->A96,
                "A97"=>$request->A97,
                "A98"=>$request->A98,
                "A99"=>$request->A99,
                "A910"=>$request->A910,
                "A911"=>$request->A911,
                "A912"=>$request->A912,
                "A913"=>$request->A913,
                "A914"=>$request->A914,
                "A915"=>$request->A915,
                "A916"=>$request->A916,
                "A917"=>$request->A917,
                "A918"=>$request->A918,
                "A919"=>$request->A919,
                "A920"=>$request->A920,
                "A921"=>$request->A921,
                "A922"=>$request->A922,
                "A923"=>$request->A923,
                "A924"=>$request->A924,

                "A71"=>$request->A71,
                "A72"=>$request->A72,
                "A73"=>$request->A73,
                "A74"=>$request->A74,
                "A75"=>$request->A75,
                "A76"=>$request->A76,
                "A77"=>$request->A77,
                "A78"=>$request->A78,
                "A79"=>$request->A79,
                "A710"=>$request->A710,
                "A711"=>$request->A711,
                "A712"=>$request->A712,
                "A713"=>$request->A713,
                "A714"=>$request->A714,
                "A715"=>$request->A715,
                "A716"=>$request->A716,
                "A717"=>$request->A717,
                "A718"=>$request->A718,
                "A719"=>$request->A719,
                "A720"=>$request->A720,
                "A721"=>$request->A721,
                "A722"=>$request->A722,
                "A723"=>$request->A723,
                "A724"=>$request->A724,

                "A51"=>$request->A51,
                "A52"=>$request->A52,
                "A53"=>$request->A53,
                "A54"=>$request->A54,
                "A55"=>$request->A55,
                "A56"=>$request->A56,
                "A57"=>$request->A57,
                "A58"=>$request->A58,
                "A59"=>$request->A59,
                "A510"=>$request->A510,
                "A511"=>$request->A511,
                "A512"=>$request->A512,
                "A513"=>$request->A513,
                "A514"=>$request->A514,
                "A515"=>$request->A515,
                "A516"=>$request->A516,
                "A517"=>$request->A517,
                "A518"=>$request->A518,
                "A519"=>$request->A519,
                "A520"=>$request->A520,
                "A521"=>$request->A521,
                "A522"=>$request->A522,
                "A523"=>$request->A523,
                "A524"=>$request->A524,

                "A31"=>$request->A31,
                "A32"=>$request->A32,
                "A33"=>$request->A33,
                "A34"=>$request->A34,
                "A35"=>$request->A35,
                "A36"=>$request->A36,
                "A37"=>$request->A37,
                "A38"=>$request->A38,
                "A39"=>$request->A39,
                "A310"=>$request->A310,
                "A311"=>$request->A311,
                "A312"=>$request->A312,
                "A313"=>$request->A313,
                "A314"=>$request->A314,
                "A315"=>$request->A315,
                "A316"=>$request->A316,
                "A317"=>$request->A317,
                "A318"=>$request->A318,
                "A319"=>$request->A319,
                "A320"=>$request->A320,
                "A321"=>$request->A321,
                "A322"=>$request->A322,
                "A323"=>$request->A323,
                "A324"=>$request->A324,

                "A11"=>$request->A11,
                "A12"=>$request->A12,
                "A13"=>$request->A13,
                "A14"=>$request->A14,
                "A15"=>$request->A15,
                "A16"=>$request->A16,
                "A17"=>$request->A17,
                "A18"=>$request->A18,
                "A19"=>$request->A19,
                "A110"=>$request->A110,
                "A111"=>$request->A111,
                "A112"=>$request->A112,
                "A113"=>$request->A113,
                "A114"=>$request->A114,
                "A115"=>$request->A115,
                "A116"=>$request->A116,
                "A117"=>$request->A117,
                "A118"=>$request->A118,
                "A119"=>$request->A119,
                "A120"=>$request->A120,
                "A121"=>$request->A121,
                "A122"=>$request->A122,
                "A123"=>$request->A123,
                "A124"=>$request->A124,

                "B91"=>$request->B91,
                "B92"=>$request->B92,
                "B93"=>$request->B93,
                "B94"=>$request->B94,
                "B95"=>$request->B95,
                "B96"=>$request->B96,
                "B97"=>$request->B97,
                "B98"=>$request->B98,
                "B99"=>$request->B99,
                "B910"=>$request->B910,
                "B911"=>$request->B911,
                "B912"=>$request->B912,
                "B913"=>$request->B913,
                "B914"=>$request->B914,
                "B915"=>$request->B915,
                "B916"=>$request->B916,
                "B917"=>$request->B917,
                "B918"=>$request->B918,
                "B919"=>$request->B919,
                "B920"=>$request->B920,
                "B921"=>$request->B921,
                "B922"=>$request->B922,
                "B923"=>$request->B923,
                "B924"=>$request->B924,

                "B71"=>$request->B71,
                "B72"=>$request->B72,
                "B73"=>$request->B73,
                "B74"=>$request->B74,
                "B75"=>$request->B75,
                "B76"=>$request->B76,
                "B77"=>$request->B77,
                "B78"=>$request->B78,
                "B79"=>$request->B79,
                "B710"=>$request->B710,
                "B711"=>$request->B711,
                "B712"=>$request->B712,
                "B713"=>$request->B713,
                "B714"=>$request->B714,
                "B715"=>$request->B715,
                "B716"=>$request->B716,
                "B717"=>$request->B717,
                "B718"=>$request->B718,
                "B719"=>$request->B719,
                "B720"=>$request->B720,
                "B721"=>$request->B721,
                "B722"=>$request->B722,
                "B723"=>$request->B723,
                "B724"=>$request->B724,

                "B51"=>$request->B51,
                "B52"=>$request->B52,
                "B53"=>$request->B53,
                "B54"=>$request->B54,
                "B55"=>$request->B55,
                "B56"=>$request->B56,
                "B57"=>$request->B57,
                "B58"=>$request->B58,
                "B59"=>$request->B59,
                "B510"=>$request->B510,
                "B511"=>$request->B511,
                "B512"=>$request->B512,
                "B513"=>$request->B513,
                "B514"=>$request->B514,
                "B515"=>$request->B515,
                "B516"=>$request->B516,
                "B517"=>$request->B517,
                "B518"=>$request->B518,
                "B519"=>$request->B519,
                "B520"=>$request->B520,
                "B521"=>$request->B521,
                "B522"=>$request->B522,
                "B523"=>$request->B523,
                "B524"=>$request->B524,

                "B31"=>$request->B31,
                "B32"=>$request->B32,
                "B33"=>$request->B33,
                "B34"=>$request->B34,
                "B35"=>$request->B35,
                "B36"=>$request->B36,
                "B37"=>$request->B37,
                "B38"=>$request->B38,
                "B39"=>$request->B39,
                "B310"=>$request->B310,
                "B311"=>$request->B311,
                "B312"=>$request->B312,
                "B313"=>$request->B313,
                "B314"=>$request->B314,
                "B315"=>$request->B315,
                "B316"=>$request->B316,
                "B317"=>$request->B317,
                "B318"=>$request->B318,
                "B319"=>$request->B319,
                "B320"=>$request->B320,
                "B321"=>$request->B321,
                "B322"=>$request->B322,
                "B323"=>$request->B323,
                "B324"=>$request->B324,

                "B11"=>$request->B11,
                "B12"=>$request->B12,
                "B13"=>$request->B13,
                "B14"=>$request->B14,
                "B15"=>$request->B15,
                "B16"=>$request->B16,
                "B17"=>$request->B17,
                "B18"=>$request->B18,
                "B19"=>$request->B19,
                "B110"=>$request->B110,
                "B111"=>$request->B111,
                "B112"=>$request->B112,
                "B113"=>$request->B113,
                "B114"=>$request->B114,
                "B115"=>$request->B115,
                "B116"=>$request->B116,
                "B117"=>$request->B117,
                "B118"=>$request->B118,
                "B119"=>$request->B119,
                "B120"=>$request->B120,
                "B121"=>$request->B121,
                "B122"=>$request->B122,
                "B123"=>$request->B123,
                "B124"=>$request->B124,
                 ]);
        }
        else{
            organoleptik::insert([
                "id_ppk"=> $id_ppk,
                "A91"=>$request->A91,
                "A92"=>$request->A92,
                "A93"=>$request->A93,
                "A94"=>$request->A94,
                "A95"=>$request->A95,
                "A96"=>$request->A96,
                "A97"=>$request->A97,
                "A98"=>$request->A98,
                "A99"=>$request->A99,
                "A910"=>$request->A910,
                "A911"=>$request->A911,
                "A912"=>$request->A912,
                "A913"=>$request->A913,
                "A914"=>$request->A914,
                "A915"=>$request->A915,
                "A916"=>$request->A916,
                "A917"=>$request->A917,
                "A918"=>$request->A918,
                "A919"=>$request->A919,
                "A920"=>$request->A920,
                "A921"=>$request->A921,
                "A922"=>$request->A922,
                "A923"=>$request->A923,
                "A924"=>$request->A924,

                "A71"=>$request->A71,
                "A72"=>$request->A72,
                "A73"=>$request->A73,
                "A74"=>$request->A74,
                "A75"=>$request->A75,
                "A76"=>$request->A76,
                "A77"=>$request->A77,
                "A78"=>$request->A78,
                "A79"=>$request->A79,
                "A710"=>$request->A710,
                "A711"=>$request->A711,
                "A712"=>$request->A712,
                "A713"=>$request->A713,
                "A714"=>$request->A714,
                "A715"=>$request->A715,
                "A716"=>$request->A716,
                "A717"=>$request->A717,
                "A718"=>$request->A718,
                "A719"=>$request->A719,
                "A720"=>$request->A720,
                "A721"=>$request->A721,
                "A722"=>$request->A722,
                "A723"=>$request->A723,
                "A724"=>$request->A724,

                "A51"=>$request->A51,
                "A52"=>$request->A52,
                "A53"=>$request->A53,
                "A54"=>$request->A54,
                "A55"=>$request->A55,
                "A56"=>$request->A56,
                "A57"=>$request->A57,
                "A58"=>$request->A58,
                "A59"=>$request->A59,
                "A510"=>$request->A510,
                "A511"=>$request->A511,
                "A512"=>$request->A512,
                "A513"=>$request->A513,
                "A514"=>$request->A514,
                "A515"=>$request->A515,
                "A516"=>$request->A516,
                "A517"=>$request->A517,
                "A518"=>$request->A518,
                "A519"=>$request->A519,
                "A520"=>$request->A520,
                "A521"=>$request->A521,
                "A522"=>$request->A522,
                "A523"=>$request->A523,
                "A524"=>$request->A524,

                "A31"=>$request->A31,
                "A32"=>$request->A32,
                "A33"=>$request->A33,
                "A34"=>$request->A34,
                "A35"=>$request->A35,
                "A36"=>$request->A36,
                "A37"=>$request->A37,
                "A38"=>$request->A38,
                "A39"=>$request->A39,
                "A310"=>$request->A310,
                "A311"=>$request->A311,
                "A312"=>$request->A312,
                "A313"=>$request->A313,
                "A314"=>$request->A314,
                "A315"=>$request->A315,
                "A316"=>$request->A316,
                "A317"=>$request->A317,
                "A318"=>$request->A318,
                "A319"=>$request->A319,
                "A320"=>$request->A320,
                "A321"=>$request->A321,
                "A322"=>$request->A322,
                "A323"=>$request->A323,
                "A324"=>$request->A324,

                "A11"=>$request->A11,
                "A12"=>$request->A12,
                "A13"=>$request->A13,
                "A14"=>$request->A14,
                "A15"=>$request->A15,
                "A16"=>$request->A16,
                "A17"=>$request->A17,
                "A18"=>$request->A18,
                "A19"=>$request->A19,
                "A110"=>$request->A110,
                "A111"=>$request->A111,
                "A112"=>$request->A112,
                "A113"=>$request->A113,
                "A114"=>$request->A114,
                "A115"=>$request->A115,
                "A116"=>$request->A116,
                "A117"=>$request->A117,
                "A118"=>$request->A118,
                "A119"=>$request->A119,
                "A120"=>$request->A120,
                "A121"=>$request->A121,
                "A122"=>$request->A122,
                "A123"=>$request->A123,
                "A124"=>$request->A124,

                "B91"=>$request->B91,
                "B92"=>$request->B92,
                "B93"=>$request->B93,
                "B94"=>$request->B94,
                "B95"=>$request->B95,
                "B96"=>$request->B96,
                "B97"=>$request->B97,
                "B98"=>$request->B98,
                "B99"=>$request->B99,
                "B910"=>$request->B910,
                "B911"=>$request->B911,
                "B912"=>$request->B912,
                "B913"=>$request->B913,
                "B914"=>$request->B914,
                "B915"=>$request->B915,
                "B916"=>$request->B916,
                "B917"=>$request->B917,
                "B918"=>$request->B918,
                "B919"=>$request->B919,
                "B920"=>$request->B920,
                "B921"=>$request->B921,
                "B922"=>$request->B922,
                "B923"=>$request->B923,
                "B924"=>$request->B924,

                "B71"=>$request->B71,
                "B72"=>$request->B72,
                "B73"=>$request->B73,
                "B74"=>$request->B74,
                "B75"=>$request->B75,
                "B76"=>$request->B76,
                "B77"=>$request->B77,
                "B78"=>$request->B78,
                "B79"=>$request->B79,
                "B710"=>$request->B710,
                "B711"=>$request->B711,
                "B712"=>$request->B712,
                "B713"=>$request->B713,
                "B714"=>$request->B714,
                "B715"=>$request->B715,
                "B716"=>$request->B716,
                "B717"=>$request->B717,
                "B718"=>$request->B718,
                "B719"=>$request->B719,
                "B720"=>$request->B720,
                "B721"=>$request->B721,
                "B722"=>$request->B722,
                "B723"=>$request->B723,
                "B724"=>$request->B724,

                "B51"=>$request->B51,
                "B52"=>$request->B52,
                "B53"=>$request->B53,
                "B54"=>$request->B54,
                "B55"=>$request->B55,
                "B56"=>$request->B56,
                "B57"=>$request->B57,
                "B58"=>$request->B58,
                "B59"=>$request->B59,
                "B510"=>$request->B510,
                "B511"=>$request->B511,
                "B512"=>$request->B512,
                "B513"=>$request->B513,
                "B514"=>$request->B514,
                "B515"=>$request->B515,
                "B516"=>$request->B516,
                "B517"=>$request->B517,
                "B518"=>$request->B518,
                "B519"=>$request->B519,
                "B520"=>$request->B520,
                "B521"=>$request->B521,
                "B522"=>$request->B522,
                "B523"=>$request->B523,
                "B524"=>$request->B524,

                "B31"=>$request->B31,
                "B32"=>$request->B32,
                "B33"=>$request->B33,
                "B34"=>$request->B34,
                "B35"=>$request->B35,
                "B36"=>$request->B36,
                "B37"=>$request->B37,
                "B38"=>$request->B38,
                "B39"=>$request->B39,
                "B310"=>$request->B310,
                "B311"=>$request->B311,
                "B312"=>$request->B312,
                "B313"=>$request->B313,
                "B314"=>$request->B314,
                "B315"=>$request->B315,
                "B316"=>$request->B316,
                "B317"=>$request->B317,
                "B318"=>$request->B318,
                "B319"=>$request->B319,
                "B320"=>$request->B320,
                "B321"=>$request->B321,
                "B322"=>$request->B322,
                "B323"=>$request->B323,
                "B324"=>$request->B324,

                "B11"=>$request->B11,
                "B12"=>$request->B12,
                "B13"=>$request->B13,
                "B14"=>$request->B14,
                "B15"=>$request->B15,
                "B16"=>$request->B16,
                "B17"=>$request->B17,
                "B18"=>$request->B18,
                "B19"=>$request->B19,
                "B110"=>$request->B110,
                "B111"=>$request->B111,
                "B112"=>$request->B112,
                "B113"=>$request->B113,
                "B114"=>$request->B114,
                "B115"=>$request->B115,
                "B116"=>$request->B116,
                "B117"=>$request->B117,
                "B118"=>$request->B118,
                "B119"=>$request->B119,
                "B120"=>$request->B120,
                "B121"=>$request->B121,
                "B122"=>$request->B122,
                "B123"=>$request->B123,
                "B124"=>$request->B124,
            ]);
        }

        

        // $data = [];
        // for ($i=1; $i<=24; $i++) {
        //     $data["A9".$i] = $request->{"A9".$i};
        // }
    
        // organoleptik::insert([
        //     "id_ppk"=> $id_ppk,
        //     $data
        // ]);


        
        // organoleptik::where('id_ppk', $id_ppk)->update([
        //     "id_ppk"=> $id_ppk,
        //     "data"=>$request->A91
        // ]);
        return redirect('/admin/organoleptik/'.$id_ppk)->with('berhasilSimpan','Data berhasil disimpan');
    }

    public function reset(Request $request){

        $id_ppk = request()->segment(3);

        $ada = DB::connection('sqlsrv2')->table('organoleptik')
            ->where('id_ppk',$id_ppk)
            ->select('*')
            ->get();

        if(count($ada) > 0){
            organoleptik::where('id_ppk', $id_ppk)->delete();

        }
        return redirect('/admin/organoleptik/'.$id_ppk)->with('berhasilSimpan','Data berhasil direset');;
    }
}
